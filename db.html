<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
    <title>GitHub Pages - Home</title>
    <link href="/stylesheets/bundle_common.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="/stylesheets/bundle_github.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="/stylesheets/screen.css" media="screen" rel="stylesheet" type="text/css" />
  </head>
  <body>
    <div id="main">
      <div id="header" class="basic">
 
        <div class="site">
          <div class="logo">
            <a href="/"><img src="/images/modules/header/logo_pages.png" alt="github pages" /></a>
          </div>
          <div class="actions">
            <a href="http://github.com">home</a>
            <a href="http://github.com/login">login</a>
            <a href="http://github.com/signup">signup!</a>
          </div>
        </div>
      </div>
 
      <div id="content" class="site">
      <div class="wikistyle">
        <h2>3.1 Проектирование базы данных</h2>

<p>Структура базы данных поделена на 5 слоёв:</p>

<ol>
<li>пользователи;</li>
<li>регионы;</li>
<li>сообщения;</li>
<li>заявки;</li>
<li>учебные программы.</li>
</ol>

<p>Слой пользователей (рисунок &#95;&#95;PIC&#95;DB&#95;LAYER&#95;USERS&#95;&#95;) состоит из 
четырёх сущностей: «Пользователи», «Паспорта», «Документы об образовании» и 
«Телефоны». Первая отвечает за хранение базовой информации о пользователях, 
такой как логин, пароль, роль пользователя, адрес электронной почты и др. В 
остальных трёх сущностях содержатся данные расширенного профиля пользователя – 
информация о паспортных данных, документах об образовании и телефонных номерах.</p>

<p><img src="/images/db-layer-users.png" alt="Слой пользователей" /></p>

<p>Рисунок &#95;&#95;PIC&#95;DB&#95;LAYER&#95;USERS&#95;&#95; – Слой пользователей</p>

<p>Данные о регионах (рисунок &#95;&#95;PIC&#95;DB&#95;LAYER&#95;REGIONS&#95;&#95;) содержат списки всех 
регионов Российской Федерации и населённых пунктов. С помощью внешних ключей 
между этими списками и паспортными данными установлена связь один-ко-многим.</p>

<p><img src="/images/db-layer-regions.png" alt="Слой регионов" /></p>

<p>Рисунок &#95;&#95;PIC&#95;DB&#95;LAYER&#95;REGIONS&#95;&#95; – Слой регионов</p>

<p>Слой заявок (рисунок &#95;&#95;PIC&#95;DB&#95;LAYER&#95;APPS&#95;&#95;) содержит 3 сущности: 
«Заявки», «История заявок» и «Платежи». В сущности «Заявки» содержатся 
идентификаторы, указывающие, какой пользователь на какую образовательную 
программу (или отдельную дисциплину из какой-либо программы) подал заявку. После 
подачи заявка проходит несколько стадий обработки. Сначала её должен одобрить 
администратор, после чего он прикрепляет к заявке договор (на файл договора 
указывает соответствующее поле). Слушатель должен подписать этот договор и 
произвести в соответствии с ним необходимую оплату. Оплата по одной заявке 
может быть произведена частями. Все эти изменения статуса заявки (подана, 
принята/отклонена, подписана, оплачена) отображаются в истории обработки заявок.</p>

<p><img src="/images/db-layer-apps.png" alt="Слой заявок" /></p>

<p>Рисунок &#95;&#95;PIC&#95;DB&#95;LAYER&#95;APPS&#95;&#95; – Слой заявок</p>

<p>В слое сообщений (рисунок &#95;&#95;PIC&#95;DB&#95;LAYER&#95;MSGS&#95;&#95;) находятся две сущности: «Сообщения» и «Прикреплённые файлы». 
Первая сущность содержит информацию о теме сообщения, его тексте, авторе 
сообщения, получателе и времени отправки сообщения. Кроме того, в этой сущности 
есть атрибут "прочитано", который представляет статус сообщения: было ли оно 
прочитано получателем или нет. Вторая сущность, «Прикреплённые файлы», 
необходима для реализации функции отправки файлов внутри сообщений. Она содержит 
данные о файле (имя файлы, тип) и идентификатор сообщения, к которому прикреплён 
данный файл.</p>

<p><img src="/images/db-layer-msgs.png" alt="Слой сообщений" /></p>

<p>Рисунок &#95;&#95;PIC&#95;DB&#95;LAYER&#95;MSGS&#95;&#95; – Слой сообщений</p>

<p>Слой учебных программ (рисунок &#95;&#95;PIC&#95;DB&#95;LAYER&#95;PROGRAMS&#95;&#95;) предназначен 
для хранения информации об учебных программах, дисциплинах, разделов и 
материалов. Каждая учебная программа имеет две типовые характеристики: специальность или 
курс, платная или бесплатная. Для каждой дисциплины установлена связь многие к 
одному с программами, для каждого раздела установлена аналогичная связь с 
дисциплиной. Помимо этого, разделы выстраиваются в иерархию родитель-потомок. 
Семантика этой иерархии заключается в следующем: пока не будет пройдена 
контрольная точка по родительскому разделу, доступ слушателю к дочернему разделу 
будет закрыт.</p>

<p><img src="/images/db-layer-programs.png" alt="Слой учебных программ" /></p>

<p>Рисунок &#95;&#95;PIC&#95;DB&#95;LAYER&#95;PROGRAMS&#95;&#95; – Слой учебных программ</p>

<p><img src="/images/db-model.png" alt="Концептуальная схема базы данных" /></p>

<p>Рисунок &#95;&#95;PIC&#95;DB&#95;MODEL&#95;&#95; – Концептуальная схема базы данных</p>

<p>Расмотрим подробнее слой пользователей, который имеет множество связей, как 
внутренних, так и внешних (с другими слоями) (рисунок &#95;&#95;PIC&#95;DB&#95;MODEL&#95;&#95;). Перечислим эти связи:</p>

<ul>
<li><p>ответственный преподаватель по программе, «Пользователи» – «Программы». Связь 
типа один-ко-многим, обозначает, какой преподаватель – ответственный за данную 
образовательную программу. Связь неидентифицирующая, допускает NULL-значения, 
поскольку для программы может быть ещё не назначен ответственный преподаватель;</p></li>
<li><p>ответственный преподаватель по дисциплине, «Пользователи» – «Дисциплины». 
Аналогична предыдущей связи, обозначет ответственного за данную дисциплину. 
Тип связи: один-ко-многим. Неидентифицирующая, допускает NULL-значения;</p></li>
<li><p>пользователь добавил материал, «Пользователи» – «Материалы». Связь типа 
один-ко-многим, обусловлена необходимостью сохранения указателя на 
пользователя, добавившего данный материал. Неидентифицирующая и не 
допускающая NULL-значений внешнего ключа, так как для каждого загружаемого 
материала обязательно запоминается тот, кто его добавляет;</p></li>
<li><p>заявка подана пользователем, «Пользователи» – «Заявки» Связь типа 
один-ко-многим, отражает соответствие заявке (на образовательную программу или 
дисциплину) пользователя, который это заявку подал. Так как любая заявка 
привязана к учётной записи пользователя, иначе она теряет смысл, то 
NULL-значения недопустимы. Связь неидентифицирующая;</p></li>
<li><p>пользователь отправил сообщение, «Пользователи» – «Сообщение». Связь типа 
один-ко-многим, указывает, какой пользователь отправил данное сообщение. Она 
неидентифицирующая и не допускает NULL-значений, так как у каждого сообщения 
обязательно есть отправитель;</p></li>
<li><p>сообщение для пользователя, «Пользователи» – «Сообщения». Связь типа 
один-ко-многим, указывает, для какого пользователя предназначено данное 
сообщение. Она неидентифицирующая и не допускает NULL-значений, так как для 
каждого сообщения обязательно указывается получатель;</p></li>
<li><p>телефоны слушателя, «Пользователи» – «Телефоны». Связь показывает, к какому 
пользователю относятся сведения о телефонах. Связь неидентифицирующая и не 
допускающая NULL-значений (все номера телефонов обязательны привязаны к 
учётной записи пользователя). Тип связи: один-к-одному;</p></li>
<li><p>документы слушателя, «Пользователи» – «Документы об образовании». Связь типа 
один-к-одному, показывает, к какому пользователю относятся сведения о 
документах об образовании. Связь неидентифицирующая и не допускающая 
NULL-значений (все документы обязательно относятся к какой-либо учётной 
записи);</p></li>
<li><p>паспортные данные слушателя, «Пользователи» – «Паспорта». Связь показывает, к 
какому пользователю относятся паспортные данные. Связь неидентифицирующая и не 
допускающая NULL-значений, потому что все паспортные данные привязаны к 
учётной записи пользователя. Тип связи: один-к-одному;</p></li>
<li><p>куратор слушателя, «Пользователи» – «Пользователи». Назначение этой связи - 
указывать, кто назначен куратором для данного слушателя. Тип: один-ко-многим. 
Связь неидентифицирующая и разрешает NULL-значения внешнего ключа, так как для 
слушателя куратор может быть назначен не сразу;</p></li>
<li><p>регион прописки, «Паспорта» – «Регионы». Связывает паспортные данные с 
регионом прописки. Неидентифицирующая и не допускает NULL-значений (сведения о 
прописке являются обязательными). Тип связи: один-ко-многим;</p></li>
<li><p>населённый пункт слушателя, «Паспорта» – «Населённые пункты». Связывает 
паспортные данные с населённым пунктом. Тип связи: один-ко-многим. 
Неидентифицирующая и не допускает NULL-значений, так как сведения о прописке 
являются обязательными;</p></li>
<li><p>населённый пункт из региона, «Населённые пункты» – «Регионы». Связь типа 
один-ко-многим, указывает, к какому региону относится тот или иной населённый 
пункт. Связь является неидентифицирующей и не допускает NULL-значения, потому 
что любой населённый пункт относится к какому-либо региону.</p></li>
</ul>

      </div>
      </div>
 
      <div class="push"></div>
    </div>
 
    <div id="footer">
      <div class="site">
 
        <div class="info">
          <div class="links">
            <a href="http://github.com/blog/148-github-shirts-now-available">T-Shirts</a> |
            <a href="http://github.com/blog">Blog</a> |
            <a href="http://support.github.com/">Support</a> |
            <a href="http://github.com/training">Git Training</a> |
            <a href="http://github.com/contact">Contact</a> |
            <a href="http://groups.google.com/group/github/">Google Group</a> |
            <a href="http://github.wordpress.com">Status</a>
          </div>
          <div class="company">
            GitHub is <a href="http://logicalawesome.com/">Logical Awesome</a> &copy;2009 | <a href="http://github.com/site/terms">Terms of Service</a> | <a href="http://github.com/site/privacy">Privacy Policy</a>
          </div>
        </div>
        <div class="sponsor">
          <div>
            Powered by the <a href="http://www.rackspace.com ">Dedicated
            Servers</a> and<br/> <a href="http://www.rackspacecloud.com">Cloud
            Computing</a> of Rackspace Hosting<span>&reg;</span>
          </div>
          <a href="http://www.rackspace.com">
            <img src="/images/modules/footer/rackspace_logo.png" alt="Dedicated Server" />
          </a>
        </div>
      </div>
    </div>
 
  </body>
</html>